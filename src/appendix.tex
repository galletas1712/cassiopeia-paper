\section{Appendix A: Proof of Correctness For Non-incentivized Construction}
\begin{theorem}{Correctness (Informal).}\label{thm:correctness_hm_appendix}
    Consider an honest dealer and a committee of size $n$ such that at least $t$ are honest.
    The social WE construction in Section~\ref{section:construction_without_incentives} is correct.
\end{theorem}
\begin{proof}[Sketch]
    First, we will prove that $\textsf{WE.Enc}_\mathcal{R}(1^{\lambda}, x, m)$ successfully returns the secret identifier $id$ in polynomial time.
    Since $Enc, \textsf{PVSS.genDist}, H, P$ are all PPT algorithms, they all return in polynomial time.
    Since the PVSS scheme is correct and $c$ was honestly generated, the \textsf{PVSS.verifyDist} check in Line 5 of \textsf{encrypt} passes.
    Similarly, since the zkSNARK scheme is correct and $\pi$ was honestly generated, the zkSNARK verifier $V$ also accepts the proof $\pi$.
    Since $\mathbb{L}$ is a safe and live ledger, \textsf{encrypt} returns $id$ in polynomial time without reverting.
    By extension, $\textsf{WE.Enc}_\mathcal{R}$ also returns $id$ in polynomial time.

    Now, we will prove that $\textsf{WE.Dec}_\mathcal{R}(1^{\lambda}, x, id)$ returns $m$ in polynomial time.
    The random oracle $H$ ensures that no secret identifiers are duplicate with overwhelming probability, so the secret with identifier $id$ corresponds to the same one encrypted in $\textsf{WE.Enc}_\mathcal{R}$.
    Since $\mathbb{L}$ is a safe and live ledger, \textsf{claim} will update $M_{id}$ will be updated to \textsc{claimed} in polynomial time.
    Furthermore, since at least $t$ committee members are honest, at least $t$ of them will have submitted their shares $\Delta$ blocks after the secret was claimed.
    By the correctness of the PVSS scheme, the shares of all honest committee members pass the \textsf{PVSS.verifyShare} check in Line 18 of \textsf{submitShare}.
    Therefore, $|S_{id}|$ will be at least $t$ after all honest committee members submit their shares.
    Furthermore, reconstruction of the secret is also polynomial time.
    Since the symmetric encryption scheme is correct and $\hat{c}$ was produced honestly, $Dec_s(\hat{c})$ returns $m$ in polynomial time.
    By extension, $\textsf{WE.Dec}_\mathcal{R}$ also returns $m$ in polynomial time.
\end{proof}
\section{Appendix B: Proof of Security For Non-incentivized Construction}
\begin{lemma}\label{lemma:non_malleability_appendix}
    Suppose an adversary is given the values $c, \mathcal{R}, x, y, \pi$ for secret $s$ generated by an honest dealer, and the adversary interacts with the contract.
    The adversary cannot obtain $s$ without a witness $w$ such that $(x, w) \in \mathcal{R}$.
\end{lemma}
\begin{proof}[Sketch]
    The only way the adversary can obtain any information about $s$ interacting with the contract is to first call \textsf{encrypt} with $(c', \mathcal{R}', x', y', \pi')$,
    then performing $\textsf{WE.Dec}_{\mathcal{R}'}(1^{\lambda}, c', x', w')$ to retrieve the secret $s'$, where $w'$ is a witness for $\mathcal{R}'$ and $x'$ already known to the adversary.
    The adversary aims to deduce non-negligible information about $s$ from $s'$ and $(c, \mathcal{R}, x, y, \pi)$.

    Suppose the adversary can extract non-negligible information about $s$.
    Because the PVSS scheme has secrecy, $s$ cannot be extracted from $c$, since $c$ is an encryption of $s$.
    Since $y$ is the output of a random oracle, all preimages are equally probable, so $y$ contains no information about $s$.
    By the zero knowledge property of the zkSNARK scheme, $\pi$ does not reveal any information about the private input $s$.
    Therefore, the adversary deduces information about $s$ using $s'$.

    Consider when $s' = s$ and $c' = c$.
    When the adversary calls \textsf{encrypt}, the ledger's safety and liveness ensures she must specify $y' = H(s \concat c \concat \mathcal{R}' \concat x')$ and produce a valid zkSNARK proof $\pi$ for the circuit in Algorithm~\ref{alg:snark_circuit}.
    By the extractable soundness property of the zkSNARK, the adversary must know the entire preimage of $y'$ prior to \textsf{encrypt}.
    The adversary must also provide $s$ such that $c = \textsf{PVSS.genDist}(s, [pk_i])$.
    Furthermore, since the preimage of $y$ and $y'$ are not equal, $y$ cannot be used in place of $y'$, nor is it related to $y'$ is any way.
    Therefore, the adversary must know $s$ prior to encryption.
    However, since the dealer is honest, the adversary cannot have access to $s$ prior to encryption, which is a contradiction.

    Now consider when $s' \neq s$ and $c' \neq c$.
    Since $s'$ is the decryption of $c'$, $c'$ must have encrypted some information about $s$.
    But $y$ contains no information about $s$, $c'$ must have been derived from $c$.
    When the adversary calls \textsf{encrypt}, the ledger's safety and liveness ensures she must specify $y' = H(s' \concat c' \concat \mathcal{R}' \concat x')$ and produce a valid zkSNARK proof $\pi$ for the circuit in Algorithm~\ref{alg:snark_circuit}.
    Because the zkSNARK is extractably sound, $y'$ is the output of a random oracle function, and $c' = \textsf{PVSS.genDist}(s', [pk_i])$ is enforced in the zkSNARK circuit,
    the adversary must know $s'$ prior to the computation of $y'$ (i.e. before the call to \textsf{encrypt}).
    But this means the adversary can know $s$ with knowledge of only $c, \mathcal{R}, x, y, \pi$, which is a contradiction.

    In either case, the adversary cannot obtain $s$ even by interacting with the contract.
\end{proof}
\begin{theorem}{Extractable Security (Informal).}\label{thm:security_hm_appendix}
    Consider an honest dealer, and a committee of size $n$ such that less than $t$ are adversarial.
    The social WE construction in Section~\ref{section:construction_without_incentives} is extractably secure.
\end{theorem}
\begin{proof}[Sketch]
    First, consider the case where the contract will accept only one secret to encrypt in its lifetime.
    The dealer is honest, so no other party (including the adversary) has access to $s$.
    Since $s$ is a bit string of length $\lambda$ and the symmetric encryption scheme is secure, $\hat{c}$ reveals nothing about $s$.
    Similarly, since the PVSS scheme has secrecy, the PVSS ciphertext $c$ reveals nothing about $s$.
    Furthermore, because less than $t$ committee members are adversarial, no coaliation of adversarial committee members can learn any information about the secret.
    The random oracle $H$ ensures that $y$ is uniformly distributed and $Pr[ y = H(s \concat c \concat \mathcal{R} \concat x) \mid c, \mathcal{R}, x ]$ is negligible, so a PPT adversary cannot learn anything about $s$ from $y$.
    By the zero knowledge property of the zkSNARK, the proof $\pi$ also reveals nothing about $s$.
    Therefore, all public values reveal nothing about $s$.

    Now, suppose the contract may accept multiple secrets in its lifetime.
    By Lemma~\ref{lemma:non_malleability_appendix}, no matter what other encryption requests the adversary makes, she cannot learn any information about $s$, even if she has access to the public arguments of all \textsf{encrypt} calls that will ever occur.

    Without having submitted a valid witness $w$, the advesary does not learn any information about $s$, whether from public data or from interacting with the contract.
    Therefore, if the adversary learns any information about $s$, they must know a valid witness $w$, and the construction is extractably secure.
\end{proof}